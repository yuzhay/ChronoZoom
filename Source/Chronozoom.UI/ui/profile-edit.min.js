var __extends=this.__extends||function(n,t){function i(){this.constructor=n}i.prototype=t.prototype,n.prototype=new i},CZ;(function(n){(function(t){var i=function(t){function i(n,i){t.call(this,n,i),this.saveButton=n.find(i.saveButton),this.logoutButton=n.find(i.logoutButton),this.usernameInput=n.find(i.usernameInput),this.emailInput=n.find(i.emailInput),this.agreeInput=n.find(i.agreeInput),this.loginPanel=$(document.body).find(i.loginPanel),this.profilePanel=$(document.body).find(i.profilePanel),this.loginPanelLogin=$(document.body).find(i.loginPanelLogin),this.initialize()}return __extends(i,t),i.prototype.validEmail=function(n){return String(n).search(/^\w+@[a-zA-Z_\.]+?\.[a-zA-Z]{2,4}$/)!=-1},i.prototype.validUsername=function(n){return String(n).search(/^[a-z0-9\-_]{4,20}$/i)!=-1},i.prototype.initialize=function(){var i=this,r=n.Service.getProfile();r.done(function(n){n.DisplayName!=null&&(i.usernameInput.val(n.DisplayName),n.DisplayName!=""&&(i.usernameInput.prop("disabled",!0),i.agreeInput.attr("checked",!0),i.agreeInput.prop("disabled",!0)),i.emailInput.val(n.Email))}),this.saveButton.click(function(){var r=i.validUsername(i.usernameInput.val());if(!r){alert("Provided incorrect username, \n'a-z', '0-9', '-', '_' - characters allowed only. ");return}if(r=i.validEmail(i.emailInput.val()),!r){alert("Provided incorrect email address");return}if(r=i.agreeInput.prop("checked"),!r){alert("Please agree with provided terms");return}n.Service.putProfile(i.usernameInput.val(),i.emailInput.val()).then(function(){i.usernameInput.prop("disabled",!0),n.Service.getProfile().done(function(n){i.loginPanelLogin.html(n.DisplayName)}),t.prototype.close.call(i)},function(n){alert("Unable to save changes. Please try again later."),console.log(n)})}),this.logoutButton.click(function(){return $.ajax({url:"/account/logout"}).done(function(){i.profilePanel.hide(),i.loginPanel.show(),t.prototype.close.call(i)})})},i.prototype.show=function(){t.prototype.show.call(this),this.activationSource.addClass("active")},i.prototype.close=function(){this.container.hide("slow",function(){}),n.Authoring.isActive=!1,this.activationSource.removeClass("active")},i}(n.UI.FormBase);t.FormEditProfile=i})(n.UI||(n.UI={}));var t=n.UI})(CZ||(CZ={}))