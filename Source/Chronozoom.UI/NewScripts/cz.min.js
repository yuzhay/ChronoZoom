var CZ;(function(n){(function(){var r={"#header-edit-form":"/ui/header-edit-form.html","#auth-edit-timeline-form":"/ui/auth-edit-timeline-form.html","#auth-edit-exhibit-form":"/ui/auth-edit-exhibit-form.html","#auth-edit-contentitem-form":"/ui/auth-edit-contentitem-form.html","$('<div><\/div>')":"/ui/contentitem-listbox.html","#profile-form":"/ui/profile-form.html","#login-form":"/ui/login-form.html"},t,i;(function(n){n._map=[],n._map[0]="Enabled",n.Enabled=0,n._map[1]="Disabled",n.Disabled=1,n._map[2]="RootCollection",n.RootCollection=2,n._map[3]="NotRootCollection",n.NotRootCollection=3})(t||(t={})),i=[{Name:"Login",Activation:t.NotRootCollection,JQueryReference:"#login-panel"},{Name:"Search",Activation:t.Enabled,JQueryReference:"#search-button"},{Name:"Tours",Activation:t.Enabled,JQueryReference:"#tours-index"},{Name:"Authoring",Activation:t.NotRootCollection,JQueryReference:".header-icon.edit-icon"},{Name:"WelcomeScreen",Activation:t.RootCollection,JQueryReference:"#welcomeScreenBack"},{Name:"Regimes",Activation:t.RootCollection,JQueryReference:".regime-link"},],$(document).ready(function(){var s,h,c,f,e,l,a,v,u,y,o,p,w;if(window.console=window.console||function(){var n={};return n.log=n.warn=n.debug=n.info=n.log=n.error=n.time=n.dir=n.profile=n.clear=n.exception=n.trace=n.assert=function(){},n}(),$(".bubbleInfo").hide(),n.Common.initialize(),n.UILoader.loadAll(r).done(function(){var t=arguments,i,r;$(".header-icon.edit-icon").click(function(){$(".header-icon.active").removeClass("active"),$(this).addClass("active");var i=new n.UI.FormHeaderEdit(t[0],{activationSource:$(this),navButton:".cz-form-nav",closeButton:".cz-form-close-btn > .cz-form-btn",titleTextblock:".cz-form-title",createTimeline:".cz-form-create-timeline",createExhibit:".cz-form-create-exhibit"});i.show()}),n.Authoring.initialize(n.Common.vc,{showCreateTimelineForm:function(i){var r=new n.UI.FormEditTimeline(t[1],{activationSource:$(".header-icon.edit-icon"),navButton:".cz-form-nav",closeButton:".cz-form-close-btn > .cz-form-btn",titleTextblock:".cz-form-title",startDate:".cz-form-time-start",endDate:".cz-form-time-end",saveButton:".cz-form-save",deleteButton:".cz-form-delete",titleInput:".cz-form-item-title",context:i});r.show()},showEditTimelineForm:function(i){var r=new n.UI.FormEditTimeline(t[1],{activationSource:$(".header-icon.edit-icon"),navButton:".cz-form-nav",closeButton:".cz-form-close-btn > .cz-form-btn",titleTextblock:".cz-form-title",startDate:".cz-form-time-start",endDate:".cz-form-time-end",saveButton:".cz-form-save",deleteButton:".cz-form-delete",titleInput:".cz-form-item-title",context:i});r.show()},showCreateExhibitForm:function(i){var r=new n.UI.FormEditExhibit(t[2],{activationSource:$(".header-icon.edit-icon"),navButton:".cz-form-nav",closeButton:".cz-form-close-btn > .cz-form-btn",titleTextblock:".cz-form-title",titleInput:".cz-form-item-title",datePicker:".cz-form-time",createArtifactButton:".cz-form-create-artifact",contentItemsListBox:".cz-listbox",saveButton:".cz-form-save",deleteButton:".cz-form-delete",contentItemsTemplate:t[4],context:i});r.show()},showEditExhibitForm:function(i){var r=new n.UI.FormEditExhibit(t[2],{activationSource:$(".header-icon.edit-icon"),navButton:".cz-form-nav",closeButton:".cz-form-close-btn > .cz-form-btn",titleTextblock:".cz-form-title",titleInput:".cz-form-item-title",datePicker:".cz-form-time",createArtifactButton:".cz-form-create-artifact",contentItemsListBox:".cz-listbox",saveButton:".cz-form-save",deleteButton:".cz-form-delete",contentItemsTemplate:t[4],context:i});r.show()},showEditContentItemForm:function(i,r,u,f){var e=new n.UI.FormEditCI(t[3],{activationSource:$(".header-icon.edit-icon"),prevForm:u,navButton:".cz-form-nav",closeButton:".cz-form-close-btn > .cz-form-btn",titleTextblock:".cz-form-title",saveButton:".cz-form-save",titleInput:".cz-form-item-title",mediaSourceInput:".cz-form-item-mediasource",mediaInput:".cz-form-item-mediaurl",descriptionInput:".cz-form-item-descr",attributionInput:".cz-form-item-attribution",mediaTypeInput:".cz-form-item-media-type",context:{exhibit:r,contentItem:i}});e.show(f)}}),i=new n.UI.FormEditProfile(t[5],{activationSource:$("#showButton"),navButton:".cz-form-nav",closeButton:".cz-form-close-btn > .cz-form-btn",titleTextblock:".cz-form-title",saveButton:"#cz-form-save",logoutButton:"#cz-form-logout",titleInput:".cz-form-item-title",usernameInput:".cz-form-username",emailInput:".cz-form-email",agreeInput:".cz-form-agree",loginPanel:"#login-panel",profilePanel:"#profile-panel",loginPanelLogin:"#profile-panel span.auth-panel-login",context:""}),$("#edit_profile_button").click(function(){i.show()}),n.Service.getProfile().done(function(n){n==""?$("#login-panel").show():n!=""&&n.DisplayName==null?($("#profile-panel").show(),$("#profile-panel input#username").focus(),i.show()):($("#profile-panel").show(),$("#profile-panel span.auth-panel-login").html(n.DisplayName))}).fail(function(){$("#login-panel").show()}),r=new n.UI.FormLogin(t[6],{activationSource:$("#showButton"),navButton:".cz-form-nav",closeButton:".cz-form-close-btn > .cz-form-btn",titleTextblock:".cz-form-title",titleInput:".cz-form-item-title",context:""}),$("#login-button").click(function(){r.show()})}),s=n.UrlNav.getURL(),h=s.superCollectionName===undefined,n.Service.superCollectionName=s.superCollectionName,n.Service.collectionName=s.collectionName,$(".fright ul li").click(function(n){$(".fright ul li").each(function(){$(this).css("background-color","")}),$(n.target).parent().css("background-color")!="#0464A2"?$(n.target).parent().css("background-color","#0464A2"):$(n.target).parent().css("background-color","")}),$("#search_button").mouseup(n.Search.onSearchClicked),$("#tours_index").mouseup(n.Tours.onTourClicked),$("#human_rect").click(function(){n.Search.navigateToBookmark(n.Common.humanityVisible)}),$("#prehuman_rect").click(function(){n.Search.navigateToBookmark(n.Common.prehistoryVisible)}),$("#life_rect").click(function(){n.Search.navigateToBookmark(n.Common.lifeVisible)}),$("#earth_rect").click(function(){n.Search.navigateToBookmark(n.Common.earthVisible)}),$("#cosmos_rect").click(function(){n.Search.navigateToBookmark(n.Common.cosmosVisible)}),$("#humanBookmark").click(function(){n.Search.navigateToBookmark(n.Common.humanityVisible)}),$("#prehistoryBookmark").click(function(){n.Search.navigateToBookmark(n.Common.prehistoryVisible)}),$("#lifeBookmark").click(function(){n.Search.navigateToBookmark(n.Common.lifeVisible)}),$("#earthBookmark").click(function(){n.Search.navigateToBookmark(n.Common.earthVisible)}),$("#cosmosBookmark").click(function(){n.Search.navigateToBookmark(n.Common.cosmosVisible)}),$("#breadcrumbs-nav-left").click(n.BreadCrumbs.breadCrumbNavLeft),$("#breadcrumbs-nav-right").click(n.BreadCrumbs.breadCrumbNavRight),$("#tour_prev").mouseout(function(){n.Common.toggleOffImage("tour_prev")}).mouseover(function(){n.Common.toggleOnImage("tour_prev")}).click(n.Tours.tourPrev),$("#tour_playpause").mouseout(function(){n.Common.toggleOffImage("tour_playpause")}).mouseover(function(){n.Common.toggleOnImage("tour_playpause")}).click(n.Tours.tourPlayPause),$("#tour_next").mouseout(function(){n.Common.toggleOffImage("tour_next")}).mouseover(function(){n.Common.toggleOnImage("tour_next")}).click(n.Tours.tourNext),$("#tour_exit").mouseout(function(){n.Common.toggleOffImage("tour_exit")}).mouseover(function(){n.Common.toggleOnImage("tour_exit")}).click(n.Tours.tourAbort),$("#tours-narration").click(n.Tours.onNarrationClick),$("#bookmarksCollapse").click(n.Tours.onBookmarksCollapse),$("#biblCloseButton").mouseout(function(){n.Common.toggleOffImage("biblCloseButton","png")}).mouseover(function(){n.Common.toggleOnImage("biblCloseButton","png")}),c=n.Common.getCookie("welcomeScreenDisallowed"),c!=null?n.Common.hideWelcomeScreen():($("#welcomeScreenOut").click(function(n){n.stopPropagation()}),$("#welcomeScreenBack").click(function(){n.Common.closeWelcomeScreen()})),i.forEach(function(n){var i=!0;n.Activation===t.Disabled&&(i=!1),n.Activation===t.NotRootCollection&&h&&(i=!1),n.Activation!==t.RootCollection||h||(i=!1),i||$(n.JQueryReference).css("display","none")}),h||(n.Authoring.isEnabled=!0),navigator.userAgent.toLowerCase().indexOf("chrome")>-1){if(/Chrome[\/\s](\d+\.\d+)/.test(navigator.userAgent)&&(f=new Number(RegExp.$1),f<14&&(u=n.Common.getCookie("new_bad_browser_agreement"),u==null||u==""))){window.location.href="testFallBackPage.htm";return}}else if(navigator.userAgent.toLowerCase().indexOf("version")>-1){if(/Version[\/\s](\d+\.\d+)/.test(navigator.userAgent)&&(f=new Number(RegExp.$1),f<5&&(u=n.Common.getCookie("new_bad_browser_agreement"),u==null||u==""))){window.location.href="testFallBackPage.htm";return}}else if(e=$.browser,l=e.msie&&parseInt(e.version,10)>=9,!l&&(a=e.mozilla&&parseInt(e.version,10)>=7,!a)){if(v=navigator.userAgent.toLowerCase().indexOf("chrome")>-1,!v&&(u=n.Common.getCookie("new_bad_browser_agreement"),u==null||u=="")){window.location.href="testFallBackPage.htm";return}return}navigator.userAgent.match(/(iPhone|iPod|iPad)/)&&document.addEventListener("touchmove",function(n){n.preventDefault()}),navigator.userAgent.indexOf("Mac")!=-1&&(y=document.getElementsByTagName("body")[0],y.style.overflow="hidden"),Seadragon.Config.imagePath=n.Settings.seadragonImagePath,n.Common.maxPermitedVerticalRange={top:0,bottom:1e7},window.location.hash&&(n.Common.startHash=window.location.hash),n.Common.loadData(),n.Search.initializeSearch(),n.Bibliography.initializeBibliography(),n.Tours.initializeToursUI();var b=n.Gestures.getGesturesStream(n.Common.vc),k=n.Gestures.applyAxisBehavior(n.Gestures.getGesturesStream(n.Common.ax)),d=b.Merge(k);n.Common.controller=new n.ViewportController.ViewportController2(function(t){var i=n.Common.vc.virtualCanvas("getViewport"),f=n.Common.axis.MarkerPosition(),e=i.pointVirtualToScreen(f,0).x,r,u,o;n.Common.vc.virtualCanvas("setVisible",t,n.Common.controller.activeAnimation),n.Common.updateAxis(n.Common.vc,n.Common.ax),i=n.Common.vc.virtualCanvas("getViewport"),n.Tours.pauseTourAtAnyAnimation&&(n.Tours.tourPause(),n.Tours.pauseTourAtAnyAnimation=!1),r=n.Common.vc.virtualCanvas("getHoveredInfodot"),u=n.Common.controller.activeAnimation!=undefined,u&&!r.id&&(o=i.pointScreenToVirtual(e,0).x,n.Common.updateMarker())},function(){return n.Common.vc.virtualCanvas("getViewport")},d),o=!0,n.Common.controller.onAnimationComplete.push(function(t){if(o=!1,n.Common.setNavigationStringTo&&n.Common.setNavigationStringTo.bookmark)n.UrlNav.navigationAnchor=n.UrlNav.navStringTovcElement(n.Common.setNavigationStringTo.bookmark,n.Common.vc.virtualCanvas("getLayerContent")),window.location.hash=n.Common.setNavigationStringTo.bookmark;else{n.Common.setNavigationStringTo&&n.Common.setNavigationStringTo.id==t&&(n.UrlNav.navigationAnchor=n.Common.setNavigationStringTo.element);var i=n.Common.vc.virtualCanvas("getViewport");window.location.hash=n.UrlNav.vcelementToNavString(n.UrlNav.navigationAnchor,i)}n.Common.setNavigationStringTo=null}),window.addEventListener("hashchange",function(){if(window.location.hash&&o&&n.Common.hashHandle){var t=window.location.hash,i=n.UrlNav.navStringToVisible(window.location.hash.substring(1),n.Common.vc);i&&(n.Common.isAxisFreezed=!0,n.Common.controller.moveToVisible(i,!0),window.location.hash!=t&&(o=!1,window.location.hash=t)),n.Common.hashHandle=!0}else o=!0}),n.Common.controller.onAnimationComplete.push(function(){}),n.Common.controller.onAnimationStarted.push(function(){}),n.Common.controller.onAnimationUpdated.push(function(n,t){n!=undefined&&t==undefined&&setTimeout(function(){},500)}),n.Common.controller.onAnimationComplete.push(function(t){n.Tours.tourBookmarkTransitionCompleted!=undefined&&n.Tours.tourBookmarkTransitionCompleted(t),n.Tours.tour!=undefined&&n.Tours.tour.state!="finished"&&(n.Tours.pauseTourAtAnyAnimation=!0)}),n.Common.controller.onAnimationUpdated.push(function(t){var i,r;n.Tours.tour!=undefined&&n.Tours.tourBookmarkTransitionInterrupted!=undefined&&(i=n.Tours.tour.state,n.Tours.tourBookmarkTransitionInterrupted(t),r=n.Tours.tour.state,i=="play"&&r=="pause"&&n.Tours.tourPause(),n.Common.setNavigationStringTo=null)}),n.Common.updateLayout(),n.Common.vc.bind("elementclick",function(t){n.Search.navigateToElement(t)}),n.Common.vc.bind("cursorPositionChanged",function(){n.Common.updateMarker()}),n.Common.ax.bind("thresholdBookmarkChanged",function(t){var i=n.UrlNav.navStringToVisible(t.Bookmark,n.Common.vc);i!=undefined&&n.Common.controller.moveToVisible(i,!1)}),n.Common.vc.bind("innerZoomConstraintChanged",function(t){n.Common.controller.effectiveExplorationZoomConstraint=t.zoomValue,n.Common.axis.allowMarkerMovesOnHover=!t.zoomValue}),n.Common.vc.bind("breadCrumbsChanged",function(t){n.BreadCrumbs.updateBreadCrumbsLabels(t.breadCrumbs)}),$(window).bind("resize",function(){n.Common.updateLayout()}),p=n.Common.vc.virtualCanvas("getViewport"),n.Common.vc.virtualCanvas("setVisible",n.VCContent.getVisibleForElement({x:-137e8,y:0,width:137e8,height:5535444444.4444447},1,p,!1),!0),n.Common.updateAxis(n.Common.vc,n.Common.ax),w=window.location.hash.match("b=([a-z0-9_]+)"),w&&($("#bibliography .sources").empty(),$("#bibliography .title").append($("<span><\/span>",{text:"Loading..."})),$("#bibliographyBack").css("display","block"))})})(n.HomePageViewModel||(n.HomePageViewModel={}));var t=n.HomePageViewModel})(CZ||(CZ={}))