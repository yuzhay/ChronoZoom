var CZ;(function(n){(function(t){function r(n){var t=n,i=!1;Object.defineProperty(this,"url",{configurable:!1,get:function(){return t}}),this.addToPath=function(n){n&&(t+=t.match(/\/$/)?n:"/"+n)},this.addParameter=function(n,r){r!==undefined&&r!==null&&(t+=i?"&":"?",t+=n+"="+r,i=!0)},this.addParameters=function(n){for(var t in n)n.hasOwnProperty(t)&&this.addParameter(t,n[t])}}function o(n){var u=new r(i);return u.addToPath("gettimelines"),u.addParameter("supercollection",t.superCollectionName),u.addParameter("collection",t.collectionName),u.addParameters(n),console.log("[GET] "+u.url),$.ajax({type:"GET",cache:!1,dataType:"json",url:u.url})}function s(){var n=new r(i);return n.addToPath(t.superCollectionName),n.addToPath("collections"),$.ajax({type:"GET",cache:!1,dataType:"json",url:n.url})}function h(n){var u=new r(i);return u.addToPath(t.superCollectionName),u.addToPath(t.collectionName),u.addToPath("structure"),u.addParameters(n),$.ajax({type:"GET",cache:!1,dataType:"json",url:u.url})}function c(n){var u=new r(i);return u.addToPath(t.superCollectionName),u.addToPath(t.collectionName),u.addToPath("data"),$.ajax({type:"POST",cache:!1,contentType:"application/json",dataType:"json",url:u.url,data:JSON.stringify(n)})}function l(n){var u=new r(i);return u.addToPath(t.superCollectionName),u.addToPath(n.name),$.ajax({type:"PUT",cache:!1,contentType:"application/json",dataType:"json",url:u.url,data:JSON.stringify(n)})}function a(n){var u=new r(i);return u.addToPath(t.superCollectionName),u.addToPath(n.name),$.ajax({type:"DELETE",cache:!1,contentType:"application/json",url:u.url,data:JSON.stringify(n)})}function v(n){var f=new r(i);return f.addToPath(t.superCollectionName),f.addToPath(t.collectionName),f.addToPath("timeline"),console.log("[PUT] "+f.url),$.ajax({type:"PUT",cache:!1,contentType:"application/json",dataType:"json",url:f.url,data:JSON.stringify(u.timeline(n))})}function y(n){var f=new r(i);return f.addToPath(t.superCollectionName),f.addToPath(t.collectionName),f.addToPath("timeline"),console.log("[DELETE] "+f.url),$.ajax({type:"DELETE",cache:!1,contentType:"application/json",url:f.url,data:JSON.stringify(u.timeline(n))})}function p(n){var f=new r(i);return f.addToPath(t.superCollectionName),f.addToPath(t.collectionName),f.addToPath("exhibit"),console.log("[PUT] "+f.url),$.ajax({type:"PUT",cache:!1,contentType:"application/json",dataType:"json",url:f.url,data:JSON.stringify(u.exhibit(n))})}function w(n){var f=new r(i);return f.addToPath(t.superCollectionName),f.addToPath(t.collectionName),f.addToPath("exhibit"),console.log("[DELETE] "+f.url),$.ajax({type:"DELETE",cache:!1,contentType:"application/json",url:f.url,data:JSON.stringify(u.exhibit(n))})}function f(n){var f=new r(i);return f.addToPath(t.superCollectionName),f.addToPath(t.collectionName),f.addToPath("contentitem"),console.log("[PUT] "+f.url),$.ajax({type:"PUT",cache:!1,contentType:"application/json",dataType:"json",url:f.url,data:JSON.stringify(u.contentItem(n))})}function e(n){var f=new r(i);return f.addToPath(t.superCollectionName),f.addToPath(t.collectionName),f.addToPath("contentitem"),console.log("[DELETE] "+f.url),$.ajax({type:"DELETE",cache:!1,contentType:"application/json",url:f.url,data:JSON.stringify(u.contentItem(n))})}function b(){var n=new t.Request(i);return n.addToPath(t.superCollectionName),n.addToPath(t.collectionName),n.addToPath("tours"),$.ajax({type:"GET",cache:!1,dataType:"json",url:n.url})}function k(n,t){var i=n.contentItems.map(function(n){return n.guid}),r=n.contentItems.map(function(n){return f(n)}).concat(t.filter(function(n){return n.guid&&i.indexOf(n.guid)===-1}).map(function(n){return e(n)}));return $.when.apply($,r)}function d(n,r){var u=new t.Request(i),f;return u.addToPath("user"),f={DisplayName:n,Email:r},$.ajax({type:"PUT",cache:!1,contentType:"application/json",url:u.url,data:JSON.stringify(f)})}function g(n){var r=new t.Request(i),u;return r.addToPath("user"),u={DisplayName:n},$.ajax({type:"DELETE",cache:!1,contentType:"application/json",url:r.url,data:JSON.stringify(u)})}function nt(){var n=new t.Request(i);return n.addToPath("profile"),$.ajax({url:"/chronozoom.svc/user"})}var u,i;(function(n){function t(n){return{id:n.guid,ParentTimelineId:n.parent.guid,FromYear:n.x,ToYear:typeof n.endDate!="undefined"?n.endDate:n.x+n.width,title:n.title,Regime:n.regime}}function i(n){return{id:n.guid,ParentTimelineId:n.parent.guid,Year:n.infodotDescription.date,title:n.title,description:undefined,contentItems:undefined}}function r(n){return{id:n.guid,ParentExhibitId:n.contentItem?n.contentItem.ParentExhibitId:n.parent,title:n.contentItem?n.contentItem.title:n.title,description:n.contentItem?n.contentItem.description:n.description,uri:n.contentItem?n.contentItem.uri:n.uri,mediaType:n.contentItem?n.contentItem.mediaType:n.mediaType,attribution:n.contentItem?n.contentItem.attribution:n.attribution,mediaSource:n.contentItem?n.contentItem.mediaSource:n.mediaSource}}n.timeline=t,n.exhibit=i,n.contentItem=r})(u||(u={})),i=n.Settings.serverUrlHost+"/chronozoom.svc/",t.Request=r,t.collectionName="",t.superCollectionName="",t.getTimelines=o,t.getCollections=s,t.getStructure=h,t.postData=c,t.putCollection=l,t.deleteCollection=a,t.putTimeline=v,t.deleteTimeline=y,t.putExhibit=p,t.deleteExhibit=w,t.putContentItem=f,t.deleteContentItem=e,t.getTours=b,t.putExhibitContent=k,t.putProfile=d,t.deleteProfile=g,t.getProfile=nt})(n.Service||(n.Service={}));var t=n.Service})(CZ||(CZ={}))