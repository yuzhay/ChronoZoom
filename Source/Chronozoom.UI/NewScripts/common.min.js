var CZ;(function(n){(function(t){function h(){t.ax=$("#axis"),t.axis=new n.Timescale(t.ax),n.VirtualCanvas.initialize(),t.vc=$("#vc"),t.vc.virtualCanvas(),n.Authoring.initialize(t.vc,{showCreateTimelineForm:n.Authoring.UI.showCreateTimelineForm,showEditTimelineForm:n.Authoring.UI.showEditTimelineForm,showCreateExhibitForm:n.Authoring.UI.showCreateExhibitForm,showEditExhibitForm:n.Authoring.UI.showEditExhibitForm,showEditContentItemForm:n.Authoring.UI.showEditContentItemForm})}function c(n,t){var i,r;return i=t.pageX-n[0].offsetLeft,r=t.pageY-n[0].offsetTop,{x:i,y:r}}function l(n){return n*n}function a(n){n&&n.stopPropagation?n.stopPropagation():n.cancelBubble=!0}function v(n,t){var u;t||(t="jpg");var i=$("#"+n).attr("src"),r=i.length,f=i.substring(0,r-7);i.substring(r-6,r-4)=="on"&&(u=f+"_off."+t,$("#"+n).attr("src",u))}function y(n,t){var u;t||(t="jpg");var i=$("#"+n).attr("src"),r=i.length,f=i.substring(0,r-7);i.substring(r-6,r-4)=="ff"&&(u=f+"on."+t,$("#"+n).attr("src",u))}function p(){$("#footerBack").show("clip",{},"slow")}function w(){e("welcomeScreenDisallowed","1",365),f()}function f(){document.createElement("welcomeVideo").src="",$("#welcomeScreenBack").css("display","none")}function b(){t.animationTooltipRunning!=null&&($(".bubbleInfo").stop(),$(".bubbleInfo").css("opacity","0.9"),$(".bubbleInfo").css("filter","alpha(opacity=90)"),$(".bubbleInfo").css("-moz-opacity","0.9"),t.animationTooltipRunning=null,$(".bubbleInfo").attr("id","defaultBox"),$(".bubbleInfo").hide())}function k(t,i){return i!=null?Math.abs(t.centerX-i.centerX)<n.Settings.allowedVisibileImprecision&&Math.abs(t.centerY-i.centerY)<n.Settings.allowedVisibileImprecision&&Math.abs(t.scale-i.scale)<n.Settings.allowedVisibileImprecision:!1}function d(t){return n.Tours.pauseTourAtAnyAnimation=!1,n.Tours.tour!=undefined&&n.Tours.tour.state=="play"&&n.Tours.tourPause(),i(t)}function i(n){if(n)return t.controller.moveToVisible(n)}function g(){t.axis.setTimeMarker(t.vc.virtualCanvas("getCursorPosition")),t.axis.setTimeBorders()}function nt(){n.Data.getTimelines(null).then(function(i){tt(i),t.vc.virtualCanvas("updateViewport"),n.Service.getTours().then(function(t){n.Tours.parseTours(t),n.Tours.initializeToursContent()},function(n){console.log("Error connecting to service:\n"+n.responseText)})},function(n){console.log("Error connecting to service:\n"+n.responseText)})}function tt(i){var f=t.vc.virtualCanvas("getLayerContent"),e;f.beginEdit(),n.Layout.Merge(i,f),f.endEdit(!0),it(i),t.startHash&&(r=n.UrlNav.navStringToVisible(t.startHash.substring(1),t.vc)),!r&&t.cosmosVisible&&(window.location.hash=t.cosmosVisible,r=n.UrlNav.navStringToVisible(t.cosmosVisible,t.vc)),r&&(t.controller.moveToVisible(r,!0),u(t.vc,t.ax),e=t.vc.virtualCanvas("getViewport"),t.startHash&&window.location.hash!==t.startHash&&(hashChangeFromOutside=!1,window.location.hash=t.startHash))}function it(r){var f=function(i){if(!i)return null;var r=t.vc.virtualCanvas("findElement","t"+i.id);return o.push(r),r&&(r=n.UrlNav.vcelementToNavString(r)),r},u=r,e,s,h,c;t.cosmosVisible=f(u),n.UrlNav.navigationAnchor=t.vc.virtualCanvas("findElement","t"+u.id),$("#regime-link-cosmos").click(function(){var r=n.UrlNav.navStringToVisible(t.cosmosVisible,t.vc);i(r)}),e=n.Layout.FindChildTimeline(u,n.Settings.earthTimelineID,!0),typeof e!="undefined"&&(t.earthVisible=f(e),$("#regime-link-earth").click(function(){var r=n.UrlNav.navStringToVisible(t.earthVisible,t.vc);i(r)}),s=n.Layout.FindChildTimeline(e,n.Settings.lifeTimelineID),typeof s!="undefined"&&(t.lifeVisible=f(s),$("#regime-link-life").click(function(){var r=n.UrlNav.navStringToVisible(t.lifeVisible,t.vc);i(r)}),h=n.Layout.FindChildTimeline(s,n.Settings.prehistoryTimelineID),typeof h!="undefined"&&(t.prehistoryVisible=f(h),$("#regime-link-prehistory").click(function(){var r=n.UrlNav.navStringToVisible(t.prehistoryVisible,t.vc);i(r)}),c=n.Layout.FindChildTimeline(h,n.Settings.humanityTimelineID,!0),typeof c!="undefined"&&(t.humanityVisible=f(c),$("#regime-link-humanity").click(function(){var r=n.UrlNav.navStringToVisible(t.humanityVisible,t.vc);i(r)}))))),t.maxPermitedVerticalRange={top:u.y,bottom:u.y+u.height},n.Settings.maxPermitedTimeRange={left:u.left,right:u.right},t.maxPermitedScale=n.UrlNav.navStringToVisible(t.cosmosVisible,t.vc).scale*1.1}function rt(){n.BreadCrumbs.visibleAreaWidth=$(".breadcrumbs-container").width(),n.BreadCrumbs.updateHiddenBreadCrumbs(),t.vc.virtualCanvas("updateViewport"),u(t.vc,t.ax),n.BreadCrumbs.updateBreadCrumbsLabels()}function u(n){var i=n.virtualCanvas("getViewport"),r=i.pointScreenToVirtual(0,0),u=i.pointScreenToVirtual(i.width,i.height),f={min:r.x,max:u.x};t.axis.update(f)}function e(n,t,i){var r=new Date,u;r.setDate(r.getDate()+i),u=escape(t)+(i==null?"":"; expires="+r.toUTCString()),document.cookie=n+"="+u}function ut(n){for(var r,u,i=document.cookie.split(";"),t=0;t<i.length;t++)if(r=i[t].substr(0,i[t].indexOf("=")),u=i[t].substr(i[t].indexOf("=")+1),r=r.replace(/^\s+|\s+$/g,""),r==n)return unescape(u);return null}function ft(n){var t=n.widthScreenToVirtual(n.width),i=n.heightScreenToVirtual(n.height),r=n.visible.centerX-t/2,u=n.visible.centerY-i/2;return{left:r,right:r+t,top:u,bottom:u+i,width:t,height:i,centerX:n.visible.centerX,centerY:n.visible.centerY,scale:n.visible.scale}}var r,s;t.maxPermitedScale,t.maxPermitedVerticalRange,t.controller,t.isAxisFreezed=!0,t.startHash,t.ax,t.axis,t.vc,t.cosmosVisible,t.earthVisible,t.lifeVisible,t.prehistoryVisible,t.humanityVisible;var o=[];t.setNavigationStringTo,t.hashHandle=!0,s=undefined,t.supercollection="",t.collection="",t.initialize=h,t.getXBrowserMouseOrigin=c,t.sqr=l,t.preventbubble=a,t.toggleOffImage=v,t.toggleOnImage=y,t.showFooter=p,t.closeWelcomeScreen=w,t.hideWelcomeScreen=f,t.animationTooltipRunning=null,t.tooltipMode="default",t.stopAnimationTooltip=b,t.compareVisibles=k,t.setVisibleByUserDirectly=d,t.setVisible=i,t.updateMarker=g,t.loadData=nt,t.updateLayout=rt,t.updateAxis=u,t.setCookie=e,t.getCookie=ut,t.viewportToViewBox=ft})(n.Common||(n.Common={}));var t=n.Common})(CZ||(CZ={}))